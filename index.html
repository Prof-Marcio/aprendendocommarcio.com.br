<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SALA M√ÅRCIO V33 - SIDEBAR PRO</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap');

        :root {
            --primary: #3b82f6;
            --sidebar-width: 320px;
            --carteira: #f59e0b;
            --parede: #1e293b;
            --zoom: 0.5;
            --fonte-size: 10px;
            --desk-size: 100%;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }

        body { 
            background: #0f172a; 
            height: 100vh; 
            display: flex; 
            overflow: hidden; 
            color: #fff;
        }

        /* --- PAINEL LATERAL (ESQUERDA) --- */
        .sidebar {
            width: var(--sidebar-width);
            background: #1e293b;
            border-right: 1px solid #334155;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 100;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            background: #111827;
            border-bottom: 2px solid var(--primary);
        }

        .sidebar-header h1 { font-size: 16px; font-weight: 900; letter-spacing: 1px; color: var(--primary); }

        .control-group { padding: 20px; border-bottom: 1px solid #334155; }
        .control-group h3 { font-size: 11px; text-transform: uppercase; color: #94a3b8; margin-bottom: 15px; letter-spacing: 1px; }

        .field { margin-bottom: 15px; }
        .field label { display: block; font-size: 11px; margin-bottom: 6px; color: #cbd5e1; }
        .field input[type="number"], .field input[type="text"] {
            width: 100%; background: #0f172a; border: 1px solid #334155; 
            padding: 10px; color: #fff; border-radius: 6px; outline: none;
        }
        .field input[type="range"] { width: 100%; accent-color: var(--primary); }
        .field input[type="color"] { width: 100%; height: 40px; border: none; background: none; cursor: pointer; }

        .btn-print {
            margin: 20px; background: var(--primary); color: white; border: none;
            padding: 15px; border-radius: 8px; font-weight: 800; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-print:hover { background: #2563eb; }

        /* --- √ÅREA DE VISUALIZA√á√ÉO (DIREITA) --- */
        .main-view {
            flex-grow: 1;
            background: #334155;
            overflow: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 40px;
            scroll-behavior: smooth;
        }

        /* O PAPEL A4 */
        .a4-page {
            width: 210mm;
            height: 297mm;
            background: #fff;
            color: #000;
            padding: 10mm;
            position: relative;
            flex-shrink: 0;
            transform: scale(var(--zoom));
            transform-origin: top center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease;
        }

        .doc-header { border: 2px solid #000; padding: 10px; margin-bottom: 10px; }
        .doc-header h2 { text-align: center; font-size: 20px; margin-bottom: 8px; }
        .doc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 12px; }

        /* A SALA DENTRO DO PAPEL */
        .sala-box {
            flex-grow: 1;
            border: 15px solid var(--parede);
            background: #fff;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .area-txt { display: flex; align-items: center; justify-content: center; min-height: 40px; font-weight: 900; font-size: 11px; text-transform: uppercase; }
        
        #gridSala {
            display: grid;
            gap: 10px;
            padding: 15px;
            flex-grow: 1;
            align-content: center;
            justify-items: center;
        }

        /* CARTEIRA */
        .carteira {
            background: var(--carteira) !important;
            width: var(--desk-size);
            aspect-ratio: 1/1;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .foto-aluno {
            width: 50%; aspect-ratio: 1/1; background: #fff; border-radius: 50%;
            border: 2px solid white; overflow: hidden; margin-bottom: 2px;
        }
        .foto-aluno img { width: 100%; height: 100%; object-fit: cover; }
        
        .nome-aluno {
            width: 100%; border: none; background: #fff; text-align: center;
            font-size: var(--fonte-size); font-weight: 800; border-radius: 2px;
        }

        /* AJUSTES MOBILE */
        @media (max-width: 900px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; max-height: 40vh; }
            .main-view { padding: 10px; }
            .a4-page { margin-top: 20px; }
        }

        @media print {
            .sidebar { display: none !important; }
            body { background: white; }
            .main-view { padding: 0; overflow: visible; display: block; }
            .a4-page { transform: scale(1) !important; margin: 0 !important; box-shadow: none; border: none; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>SALA M√ÅRCIO V33</h1>
        </div>

        <div class="control-group">
            <h3>üìè Layout da Grade</h3>
            <div class="field">
                <label>COLUNAS (LADO A LADO)</label>
                <input type="number" id="vCols" value="5" oninput="renderGrid()">
            </div>
            <div class="field">
                <label>FILEIRAS (FRENTE/FUNDO)</label>
                <input type="number" id="vRows" value="6" oninput="renderGrid()">
            </div>
        </div>

        <div class="control-group">
            <h3>üé® Estilo e Cores</h3>
            <div class="field">
                <label>COR DAS CARTEIRAS</label>
                <input type="color" id="vColorDesk" value="#f59e0b" oninput="ajustarEstilo()">
            </div>
            <div class="field">
                <label>COR DA PAREDE</label>
                <input type="color" id="vColorWall" value="#1e293b" oninput="ajustarEstilo()">
            </div>
            <div class="field">
                <label>TAMANHO CARTEIRAS: <span id="valDesk">100</span>%</label>
                <input type="range" id="vDeskSize" min="40" max="100" value="100" oninput="ajustarEstilo()">
            </div>
            <div class="field">
                <label>TAMANHO FONTE: <span id="valFont">10</span>px</label>
                <input type="range" id="vFontSize" min="6" max="14" value="9" oninput="ajustarEstilo()">
            </div>
        </div>

        <div class="control-group">
            <h3>üîç Zoom da Tela</h3>
            <input type="range" min="0.2" max="1" step="0.05" value="0.5" oninput="mudarZoom(this.value)">
        </div>

        <button class="btn-print" onclick="window.print()">
            <span>üíæ</span> GERAR PDF / IMPRIMIR
        </button>
    </aside>

    <main class="main-view">
        <div class="a4-page" id="folha">
            <div class="doc-header">
                <h2 contenteditable="true">MAPA DE ASSENTAMENTO ESCOLAR</h2>
                <div class="doc-grid">
                    <div contenteditable="true"><b>ESCOLA:</b> Nome da Escola</div>
                    <div contenteditable="true"><b>TURMA:</b> _________</div>
                    <div contenteditable="true"><b>PROFESSOR:</b> M√°rcio</div>
                    <div contenteditable="true"><b>DATA:</b> __/__/____</div>
                </div>
            </div>

            <div class="sala-box">
                <div class="area-txt" style="border-bottom: 2px dashed #eee;">
                    <span contenteditable="true" style="background:#000; color:#fff; padding:2px 10px; border-radius:4px;">SMART TV / FUNDO</span>
                </div>

                <div id="gridSala"></div>

                <div class="area-txt" style="border-top: 2px dashed #eee; justify-content: space-around; padding: 10px;">
                    <span contenteditable="true">ENTRADA</span>
                    <span contenteditable="true" style="background:#065f46; color:#fff; padding:5px 25px; border:2px solid #451a03;">QUADRO</span>
                    <span contenteditable="true">BIR√î</span>
                </div>
            </div>
        </div>
    </main>

    <script>
        function mudarZoom(v) {
            document.documentElement.style.setProperty('--zoom', v);
        }

        function ajustarEstilo() {
            const dSize = document.getElementById('vDeskSize').value;
            const fSize = document.getElementById('vFontSize').value;
            const cDesk = document.getElementById('vColorDesk').value;
            const cWall = document.getElementById('vColorWall').value;

            document.getElementById('valDesk').innerText = dSize;
            document.getElementById('valFont').innerText = fSize;

            document.documentElement.style.setProperty('--desk-size', dSize + '%');
            document.documentElement.style.setProperty('--fonte-size', fSize + 'px');
            document.documentElement.style.setProperty('--carteira', cDesk);
            document.documentElement.style.setProperty('--parede', cWall);
            
            // Salva as configs
            localStorage.setItem('v33-config', JSON.stringify({
                cols: document.getElementById('vCols').value,
                rows: document.getElementById('vRows').value,
                dSize, fSize, cDesk, cWall
            }));
        }

        function renderGrid() {
            const grid = document.getElementById('gridSala');
            const c = document.getElementById('vCols').value || 1;
            const r = document.getElementById('vRows').value || 1;

            grid.style.gridTemplateColumns = `repeat(${c}, 1fr)`;
            grid.innerHTML = '';

            for (let i = 0; i < (c * r); i++) {
                const sNome = localStorage.getItem(`v33-n-${i}`) || "";
                const sFoto = localStorage.getItem(`v33-f-${i}`) || `https://api.dicebear.com/7.x/initials/svg?seed=${i}`;
                
                const div = document.createElement('div');
                div.className = 'carteira';
                div.innerHTML = `
                    <div class="foto-aluno" onclick="document.getElementById('file-${i}').click()">
                        <img src="${sFoto}" id="img-${i}">
                    </div>
                    <input type="file" id="file-${i}" style="display:none" onchange="upload(${i}, this)">
                    <input type="text" class="nome-aluno" value="${sNome}" placeholder="Nome" oninput="localStorage.setItem('v33-n-${i}', this.value)">
                `;
                grid.appendChild(div);
            }
        }

        function upload(i, input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => {
                    document.getElementById(`img-${i}`).src = e.target.result;
                    localStorage.setItem(`v33-f-${i}`, e.target.result);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Auto-save para textos contenteditable
        document.querySelectorAll('[contenteditable]').forEach((el, index) => {
            const id = 'v33-txt-' + index;
            if(localStorage.getItem(id)) el.innerHTML = localStorage.getItem(id);
            el.oninput = () => localStorage.setItem(id, el.innerHTML);
        });

        window.onload = () => {
            const cfg = JSON.parse(localStorage.getItem('v33-config'));
            if(cfg) {
                document.getElementById('vCols').value = cfg.cols;
                document.getElementById('vRows').value = cfg.rows;
                document.getElementById('vDeskSize').value = cfg.dSize;
                document.getElementById('vFontSize').value = cfg.fSize;
                document.getElementById('vColorDesk').value = cfg.cDesk;
                document.getElementById('vColorWall').value = cfg.cWall;
                ajustarEstilo();
            }
            renderGrid();
        };
    </script>
</body>
</html>