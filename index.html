<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SALA M√ÅRCIO V28 - TUTORIAL COMPLETO</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        :root {
            --primary: #3b82f6;
            --success: #10b981;
            --bg-body: #f1f5f9;
            --parede: #1e293b;
            --fundo-sala: #ffffff;
            --cor-carteira: #f59e0b;
            --zoom: 1;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }

        body { background: var(--bg-body); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        header { background: var(--parede); color: white; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 10; }
        header h1 { font-size: 14px; font-weight: 800; }

        .main-container { flex-grow: 1; overflow: auto; padding: 20px; display: flex; justify-content: center; align-items: flex-start; position: relative; }

        /* MODOS DE VISUALIZA√á√ÉO */
        .preview-mode .a4-page { width: 210mm; height: 297mm; transform: scale(var(--zoom)); transform-origin: top center; margin-bottom: -150mm; }
        .edit-mode .a4-page { width: 100%; max-width: 600px; height: auto; padding: 15px; }

        .a4-page { background: #fff; padding: 10mm; position: relative; flex-shrink: 0; box-shadow: 0 4px 20px rgba(0,0,0,0.1); display: flex; flex-direction: column; transition: all 0.3s ease; }
        .sala-box { width: 100%; flex-grow: 1; border: 8px solid var(--parede); background: var(--fundo-sala); border-radius: 4px; display: flex; flex-direction: column; }

        .grid-alunos { display: grid; gap: 8px; padding: 10px; flex-grow: 1; }
        .desk { background: var(--cor-carteira) !important; width: 100%; aspect-ratio: 1/1; border-radius: 6px; padding: 4px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; border: 1px solid rgba(0,0,0,0.1); }
        .foto-aluno { width: 50%; aspect-ratio: 1/1; background: white; border-radius: 50%; overflow: hidden; border: 2px solid white; cursor: pointer; }
        .foto-aluno img { width: 100%; height: 100%; object-fit: cover; }
        .nome-aluno { width: 100%; border: none; border-radius: 3px; font-size: 8px; font-weight: 700; text-align: center; text-transform: uppercase; }

        /* FOOTER E BOT√ïES */
        footer { background: white; border-top: 1px solid #e2e8f0; padding: 10px 5px; padding-bottom: calc(10px + env(safe-area-inset-bottom)); }
        .toolbar { display: flex; justify-content: space-around; align-items: center; max-width: 600px; margin: 0 auto; }
        .tool-btn { display: flex; flex-direction: column; align-items: center; background: none; border: none; color: #64748b; font-size: 10px; font-weight: 600; min-width: 60px; }
        .tool-btn.active { color: var(--primary); }
        .icon-box { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 12px; background: #f8fafc; margin-bottom: 4px; font-size: 18px; }
        .active .icon-box { background: #eff6ff; border: 1px solid var(--primary); }
        .btn-main { background: var(--primary) !important; color: white !important; border-radius: 12px !important; padding: 10px 15px; }

        /* MODAIS */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: white; width: 100%; max-width: 500px; border-radius: 20px; padding: 25px; max-height: 90vh; overflow-y: auto; }
        .step { margin-bottom: 15px; padding-left: 30px; position: relative; font-size: 14px; line-height: 1.4; }
        .step-num { position: absolute; left: 0; top: 0; width: 22px; height: 22px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 800; }

        @media print {
            header, footer, .modal { display: none !important; }
            .main-container { padding: 0; display: block; }
            .a4-page { transform: scale(1) !important; margin: 0 !important; width: 210mm; height: 297mm; }
        }
    </style>
</head>
<body class="edit-mode">

<header>
    <h1>SALA M√ÅRCIO V28</h1>
    <button onclick="document.getElementById('modalTutorial').style.display='flex'" style="background:none; border:1px solid white; color:white; padding:4px 8px; border-radius:5px; font-size:10px;">AJUDA / TUTORIAL</button>
</header>

<div id="modalTutorial" class="modal" style="display: flex;">
    <div class="modal-content">
        <h2 style="color:var(--primary); margin-bottom:15px;">Como usar o App:</h2>
        <div class="step"><span class="step-num">1</span><b>Editar Nomes:</b> Toque no campo branco debaixo da carteira e digite o nome do aluno.</div>
        <div class="step"><span class="step-num">2</span><b>Colocar Fotos:</b> Toque no c√≠rculo da foto. A galeria do seu celular abrir√° automaticamente.</div>
        <div class="step"><span class="step-num">3</span><b>Ajustar Sala:</b> Clique em "AJUSTES" no menu inferior para mudar quantas fileiras e colunas a sala tem.</div>
        <div class="step"><span class="step-num">4</span><b>Ver Resultado:</b> Clique em "VER FOLHA" para ver como o desenho est√° ficando no papel A4.</div>
        <div class="step"><span class="step-num">5</span><b>Gerar PDF:</b> Clique no bot√£o azul "SALVAR PDF" para criar o arquivo pronto para imprimir.</div>
        <button class="btn-main" style="width:100%; border:none; margin-top:10px;" onclick="this.parentElement.parentElement.style.display='none'">ENTENDI, VAMOS COME√áAR!</button>
    </div>
</div>

<main class="main-container">
    <div class="a4-page" id="folha">
        <h2 contenteditable="true" style="text-align:center; margin-bottom:10px; font-size: 18px;">PLANO DE SALA: _________</h2>
        <div class="sala-box">
            <div style="height:30px; display:flex; justify-content:center; align-items:center; background:#f8fafc; font-size:8px; font-weight:800;">TV / FUNDO</div>
            <div id="grid" class="grid-alunos"></div>
            <div style="height:60px; display:flex; justify-content:center; align-items:center; background:#f8fafc; position:relative;">
                <div style="width:50%; height:30px; border:2px solid #451a03; background:#065f46; color:white; display:flex; align-items:center; justify-content:center; font-size:10px; border-radius:4px;">QUADRO</div>
            </div>
        </div>
    </div>
</main>

<div id="modalSettings" class="modal" onclick="if(event.target==this) this.style.display='none'">
    <div class="modal-content" style="margin-top: auto; border-radius: 25px 25px 0 0;">
        <h3 style="margin-bottom:20px;">Ajustes da Sala</h3>
        <label style="font-size:12px; font-weight:700;">COLUNAS (LADO A LADO)</label>
        <input type="number" id="cols" style="width:100%; padding:15px; margin:10px 0 20px; border-radius:10px; border:1px solid #ddd;" value="5" onchange="render()">
        
        <label style="font-size:12px; font-weight:700;">FILEIRAS (FRENTE/FUNDO)</label>
        <input type="number" id="rows" style="width:100%; padding:15px; margin:10px 0 20px; border-radius:10px; border:1px solid #ddd;" value="6" onchange="render()">
        
        <button class="btn-main" style="width:100%; border:none;" onclick="document.getElementById('modalSettings').style.display='none'">APLICAR MUDAN√áAS</button>
    </div>
</div>

<footer>
    <div class="toolbar">
        <button class="tool-btn active" id="btnEdit" onclick="setMode('edit')">
            <div class="icon-box">‚úçÔ∏è</div>EDITAR
        </button>
        <button class="tool-btn" id="btnPreview" onclick="setMode('preview')">
            <div class="icon-box">üìÑ</div>VER FOLHA
        </button>
        <button class="tool-btn" onclick="document.getElementById('modalSettings').style.display='flex'">
            <div class="icon-box">‚öôÔ∏è</div>AJUSTES
        </button>
        <button class="tool-btn btn-main" onclick="window.print()">
            <div style="font-size:16px; margin-bottom:2px;">üíæ</div>PDF
        </button>
    </div>
</footer>

<script>
    function setMode(mode) {
        const b = document.body;
        if(mode === 'preview') {
            b.classList.replace('edit-mode', 'preview-mode');
            document.getElementById('btnPreview').classList.add('active');
            document.getElementById('btnEdit').classList.remove('active');
            autoZoom();
        } else {
            b.classList.replace('preview-mode', 'edit-mode');
            document.getElementById('btnEdit').classList.add('active');
            document.getElementById('btnPreview').classList.remove('active');
        }
    }

    function autoZoom() {
        const zoom = ((window.innerWidth - 40) / 793).toFixed(2);
        document.documentElement.style.setProperty('--zoom', zoom);
    }

    function render() {
        const grid = document.getElementById('grid');
        const c = parseInt(document.getElementById('cols').value) || 1;
        const r = parseInt(document.getElementById('rows').value) || 1;
        grid.style.gridTemplateColumns = `repeat(${c}, 1fr)`;
        grid.innerHTML = '';
        for (let i = 0; i < (r * c); i++) {
            const cell = document.createElement('div');
            cell.className = 'desk';
            cell.innerHTML = `
                <div class="foto-aluno" onclick="this.nextElementSibling.click()"><img src="https://api.dicebear.com/7.x/initials/svg?seed=${i}"></div>
                <input type="file" style="display:none" accept="image/*" onchange="subir(this)">
                <input type="text" class="nome-aluno" placeholder="NOME">
            `;
            grid.appendChild(cell);
        }
    }

    function subir(input) {
        if (input.files && input.files[0]) {
            const r = new FileReader();
            r.onload = e => input.previousElementSibling.querySelector('img').src = e.target.result;
            r.readAsDataURL(input.files[0]);
        }
    }

    window.onload = render;
    window.onresize = autoZoom;
</script>
</body>
</html>